############################################################
#############  开发环境安全配置
#############  Development Security Configuration
############################################################

##########################################################################
#############  安全认证配置
##########################################################################
topinfo:
  # 安全配置
  security:
    # 启用鉴权控制
    enable: true
    # 密码传输是否加密，默认不加密
    password-encryption: true
    # 认证配置
    authentication:
      # 配置不需要认证的路径
      excludePaths:
        - /static/**
        - /sys/captcha/**
        - /sys/file/preview-pdf
        - /sys/person/account-findpwd
        - /sys/person/check-vcode
        - /sys/**
        - /sys/person/getUserInfo
        # 图形验证
        - /**
        - /api/**
        - /app/sys/captcha/verification-image
        - /platform/captcha/get-slider-captcha
        # 附件下载
        - /sys/file/download
        - /app/sys/file/download
        - /app/**
        - /api/**
        - /platform/**
        - /app/sys/file/upload
        - /app/trainoffline/**
        - /gdemergencyvehicle/sgddcreservation/**
        - /common/clientlogin/getPhoneByLoginName
        - /common/clientlogin/sendMsg
        - /common/clientlogin/checkPhoneCode
        - /taskcheck/siccheckpoint/**
        - /taskcheck/sicchecktask/**
        # 开发环境额外路径
        - /druid/**
        - /actuator/**

      # 密码策略配置
      password-policy:
        # 密码长度配置
        length:
          min: 6                    # 开发环境降低要求，最小6位
          max: 20                   # 最大20位
        
        # 密码复杂度配置
        complexity:
          enabled: true             # 启用复杂度验证
          require-uppercase: false  # 开发环境不强制大写字母
          require-lowercase: true   # 必须包含小写字母
          require-digit: true       # 必须包含数字
          require-special: false    # 开发环境不强制特殊字符
          allowed-special-chars: "@$!%*?&" # 允许的特殊字符集
          custom-regex: ""          # 自定义正则表达式（为空则使用复杂度规则）
        
        # 弱密码检测
        weak-password:
          enabled: true             # 启用弱密码检测
          blacklist:                # 弱密码黑名单
            - "123456"
            - "password"
            - "admin123"
            - "12345678"
            - "qwerty"
          check-username-similarity: true  # 检查与用户名相似度
          min-strength-level: 1     # 开发环境允许弱密码（1=弱，2=中，3=强）
      
      # 账户锁定策略配置
      account-lockout:
        enabled: true               # 启用账户锁定功能
        max-attempts: 10            # 开发环境放宽限制，最大10次错误
        lockout-duration: 10        # 锁定10分钟
        max-total-attempts: 30      # 累计最大错误次数30次
        reset-attempts-after: 60    # 错误次数重置时间60分钟
        lockout-type: "temporary"   # 临时锁定（默认）temporary,超过 lockoutDuration 时间后自动解锁; 永久锁定 permanent, 需要管理员手动解锁;

############################################################
#############  文件服务器配置
############################################################
  jdfs:
    client:
      # 模式： 本地模式（local）-默认，服务器模式（server）
      model: local
      local:
        logical-disk:
          # 逻辑盘名称
          D1:
            # 开发环境存储目录
            dir: D:\upload\jdfs
            # 盘的读写 rw
            status: rw

############################################################
#############  Keycloak 配置（开发环境）
############################################################
keycloak:
  # Keycloak 服务器地址
  server-url: https://sso.shxdx.com
  # Realm 名称
  realm: ps-realm
  sso:
    # 启用 Keycloak SSO
    enabled: true
    # Keycloak 服务器地址
    server-url: https://sso.shxdx.com
    # Realm 名称
    realm: ps-realm
    # 客户端 ID
    client-id: ps-be
    # 客户端密钥（开发环境可以明文，生产环境使用环境变量）
    client-secret: M4ptBhn40qsnE9njVVEt96d9aqI8Hwmb
    # 回调重定向配置
    redirect:
      # 登录成功后重定向地址
      success-url: https://mid.shxdx.com/#/sso/login
      # 登录失败后重定向地址
      error-url: https://mid.shxdx.com/#/login 
    # JWT 验证配置
    jwt:
      # 是否验证 Token 过期时间
      verify-expiration: true
      # 是否验证签发者
      verify-issuer: true
      # 是否验证受众
      verify-audience: false
      # Token 缓存时间（秒）
      cache-ttl: 300
    # 用户信息头配置（从 Nginx 代理获取）
    user-header:
      # 用户 ID 头名称
      user-id-header: X-User-Id
      # 用户名头名称
      username-header: X-Username
      # 邮箱头名称
      email-header: X-User-Email
      # 姓名头名称
      name-header: X-User-Name
      # 角色头名称
      roles-header: X-User-Roles
      # 权限头名称
      permissions-header: X-User-Permissions
  # 管理员配置
  admin:
    # 管理员客户端ID
    client-id: admin-cli
    # 管理员用户名
    username: admin
    # 管理员密码
    password: admin123

############################################################
#############  邮件服务配置（开发环境）
############################################################
spring:
  mail:
    # SMTP服务器地址
    host: smtp.163.com
    # SMTP服务器端口（163邮箱SSL端口）
    port: 465
    # 发送邮件的邮箱账号
    username: 18069853753@163.com
    # 邮箱密码或授权码
    password: WQbFDS7fdK92fKcU
    # 邮件编码
    default-encoding: UTF-8
    # SMTP配置
    properties:
      mail:
        smtp:
          # 启用SMTP认证
          auth: true
          # 启用SSL加密
          ssl:
            enable: true
          # SSL端口
          socketFactory:
            port: 465
            class: javax.net.ssl.SSLSocketFactory
            fallback: false