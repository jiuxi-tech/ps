# 包命名规范（DDD 分层）

适用范围：`ps-be` 后端代码库全局；新增与重构均需遵循。

## 根包与总体结构

- 根包固定为：`com.jiuxi`
- 一级分层：`app`、`module`、`infra`、`intf`、`shared`
- 禁止在分层之外创建新的“技术导向”一级包（如 `admin`、`core`、`platform` 等）；渐进收敛至上述分层。

## 各层包结构

1) 应用层 `com.jiuxi.app`
- 子包：`service`、`command`、`query`、`assembler`、`dto`、`config`
- 命名示例：
  - 服务类：`UserAppService`、`OrgAppService`
  - 命令对象：`CreateUserCommand`、`UpdateRoleCommand`
  - 查询对象：`UserPageQuery`、`RoleListQuery`
  - 转换器：`UserAssembler`、`RoleAssembler`
  - DTO：`UserDTO`、`RoleDTO`

2) 领域模块 `com.jiuxi.module.{context}`
- 子层：`domain`、`app`、`infra`、`intf`
- 规范：
  - 统一使用 `intf`，历史包名 `interfaces` 视为过渡名称，后续逐步迁移到 `intf`。
  - `domain` 内仅包含：`entity`、`valueobject`、`service`、`repository`、`event`、`factory` 等纯领域模型。
  - `app` 为模块内应用编排（如用例服务），避免技术依赖渗入。
  - `infra` 为模块内技术实现（持久化、外部调用等）。
  - `intf` 为模块对外适配层（web/rpc/mq/scheduler）。

3) 基础设施层 `com.jiuxi.infra`
- 子包：`persistence`、`cache`、`messaging`、`external`、`config`
- 面向跨模块的技术实现与配置，避免承载业务逻辑。

4) 接口适配层 `com.jiuxi.intf`
- 子包：`web`、`rpc`、`mq`、`scheduler`
- 仅做协议/适配与编排，业务由应用层/领域层承担。

5) 共享内核 `com.jiuxi.shared`
- 子包：`util`、`exception`、`constant`、`security`、`common`
- 渐进将历史 `com.jiuxi.common` 能力迁移至 `shared`，并在 `shared/common` 做过渡聚合。

## 类命名约定

- 领域实体：名词为主，必要时后缀 `Entity`，如 `User`/`UserEntity`（二选一，项目内保持一致）
- 值对象：后缀 `VO` 或明确名词，如 `Email`、`UserName`
- 仓储接口：后缀 `Repository`，如 `UserRepository`
- 领域服务：后缀 `DomainService`，如 `UserDomainService`
- 应用服务：后缀 `AppService`，如 `UserAppService`
- 适配器/网关：后缀 `Adapter`/`Gateway`
- 事件：后缀 `Event`，如 `UserRegisteredEvent`

## 其他约定

- 包名一律小写、使用单数，避免缩写（除约定词如 `dto`、`vo` 等）。
- 同名职责在不同层以所在层体现语义，不重复层语义作为类名前缀（如 `AppUserService` 应为 `UserAppService`）。
- 禁止跨层“倒灌”类（例如将 Controller 放在 `app` 层）。

## 迁移指引（增量）

- 新代码严格按规范创建；
- 旧包名（如 `interfaces`、`common`）以“先适配、后迁移”的策略逐步更名；
- 迁移需保持 API/行为向后兼容，并配套回滚点与验证用例。

