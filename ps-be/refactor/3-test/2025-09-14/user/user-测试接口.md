# user模块接口测试文档

## 1. 获取当前用户信息接口测试

### 测试用例1: 正常获取用户信息
**测试步骤**:
1. 使用有效的JWT Token访问 `/api/v1/users/me` 接口
2. 检查响应状态码为200
3. 验证返回的PersonVO对象包含正确的用户信息

**预期结果**:
- 响应状态码: 200
- 返回数据: 包含用户基本信息的PersonVO对象

### 测试用例2: 无认证信息访问
**测试步骤**:
1. 不带JWT Token访问 `/api/v1/users/me` 接口
2. 检查响应状态码

**预期结果**:
- 响应状态码: 401或相应的错误码

## 2. 创建用户接口测试

### 测试用例1: 正常创建用户
**测试步骤**:
1. 准备有效的UserCreateDTO数据
2. 设置必要的请求头(X-User-Person-Id, X-Tenant-Id)
3. 调用POST `/api/v1/users` 接口
4. 检查响应状态码和返回的personId

**预期结果**:
- 响应状态码: 200
- 返回数据: 新创建用户的personId

### 测试用例2: 创建用户数据验证失败
**测试步骤**:
1. 准备无效的UserCreateDTO数据(如缺少必填字段)
2. 设置必要的请求头
3. 调用POST `/api/v1/users` 接口
4. 检查响应状态码和错误信息

**预期结果**:
- 响应状态码: 200
- 返回数据: 错误信息，创建失败

## 3. 更新用户信息接口测试

### 测试用例1: 正常更新用户信息
**测试步骤**:
1. 准备有效的UserUpdateDTO数据
2. 设置必要的请求头(X-User-Person-Id, X-Tenant-Id)
3. 调用PUT `/api/v1/users/{personId}` 接口
4. 检查响应状态码

**预期结果**:
- 响应状态码: 200
- 返回数据: "更新成功"

### 测试用例2: 更新不存在的用户
**测试步骤**:
1. 准备有效的UserUpdateDTO数据
2. 使用不存在的personId
3. 设置必要的请求头
4. 调用PUT `/api/v1/users/{personId}` 接口
5. 检查响应状态码和错误信息

**预期结果**:
- 响应状态码: 200
- 返回数据: 错误信息，用户不存在

## 4. 查看用户详情接口测试

### 测试用例1: 正常查看用户详情
**测试步骤**:
1. 使用存在的personId
2. 调用GET `/api/v1/users/{personId}` 接口
3. 检查响应状态码和返回的用户详情

**预期结果**:
- 响应状态码: 200
- 返回数据: UserResponseDTO对象

### 测试用例2: 查看不存在的用户详情
**测试步骤**:
1. 使用不存在的personId
2. 调用GET `/api/v1/users/{personId}` 接口
3. 检查响应状态码和错误信息

**预期结果**:
- 响应状态码: 200
- 返回数据: 错误信息，用户不存在

## 5. 根据用户名查询用户接口测试

### 测试用例1: 正常根据用户名查询用户
**测试步骤**:
1. 使用存在的用户名
2. 设置X-Tenant-Id请求头
3. 调用GET `/api/v1/users/username/{username}` 接口
4. 检查响应状态码和返回的用户信息

**预期结果**:
- 响应状态码: 200
- 返回数据: UserResponseDTO对象

### 测试用例2: 查询不存在的用户名
**测试步骤**:
1. 使用不存在的用户名
2. 设置X-Tenant-Id请求头
3. 调用GET `/api/v1/users/username/{username}` 接口
4. 检查响应状态码和错误信息

**预期结果**:
- 响应状态码: 200
- 返回数据: 错误信息，用户不存在

## 6. 根据部门查询用户列表接口测试

### 测试用例1: 正常根据部门查询用户列表
**测试步骤**:
1. 使用存在的部门ID
2. 调用GET `/api/v1/users/departments/{deptId}` 接口
3. 检查响应状态码和返回的用户列表

**预期结果**:
- 响应状态码: 200
- 返回数据: UserResponseDTO对象列表

### 测试用例2: 查询不存在的部门
**测试步骤**:
1. 使用不存在的部门ID
2. 调用GET `/api/v1/users/departments/{deptId}` 接口
3. 检查响应状态码和返回的数据

**预期结果**:
- 响应状态码: 200
- 返回数据: 空列表或相应提示

## 7. 删除用户接口测试

### 测试用例1: 正常删除用户
**测试步骤**:
1. 使用存在的personId
2. 设置X-User-Person-Id请求头
3. 调用DELETE `/api/v1/users/{personId}` 接口
4. 检查响应状态码

**预期结果**:
- 响应状态码: 200
- 返回数据: "删除成功"

### 测试用例2: 删除不存在的用户
**测试步骤**:
1. 使用不存在的personId
2. 设置X-User-Person-Id请求头
3. 调用DELETE `/api/v1/users/{personId}` 接口
4. 检查响应状态码和错误信息

**预期结果**:
- 响应状态码: 200
- 返回数据: 错误信息，用户不存在

## 8. 批量删除用户接口测试

### 测试用例1: 正常批量删除用户
**测试步骤**:
1. 准备存在的用户ID列表
2. 设置X-User-Person-Id请求头
3. 调用DELETE `/api/v1/users/batch` 接口
4. 检查响应状态码

**预期结果**:
- 响应状态码: 200
- 返回数据: "批量删除成功"

### 测试用例2: 批量删除部分不存在的用户
**测试步骤**:
1. 准备包含不存在用户ID的列表
2. 设置X-User-Person-Id请求头
3. 调用DELETE `/api/v1/users/batch` 接口
4. 检查响应状态码和错误信息

**预期结果**:
- 响应状态码: 200
- 返回数据: 相应的错误信息

## 9. 激活用户接口测试

### 测试用例1: 正常激活用户
**测试步骤**:
1. 使用存在的personId
2. 设置X-User-Person-Id请求头
3. 调用PUT `/api/v1/users/{personId}/activate` 接口
4. 检查响应状态码

**预期结果**:
- 响应状态码: 200
- 返回数据: "激活成功"

### 测试用例2: 激活不存在的用户
**测试步骤**:
1. 使用不存在的personId
2. 设置X-User-Person-Id请求头
3. 调用PUT `/api/v1/users/{personId}/activate` 接口
4. 检查响应状态码和错误信息

**预期结果**:
- 响应状态码: 200
- 返回数据: 错误信息，用户不存在

## 10. 停用用户接口测试

### 测试用例1: 正常停用用户
**测试步骤**:
1. 使用存在的personId
2. 设置X-User-Person-Id请求头
3. 调用PUT `/api/v1/users/{personId}/deactivate` 接口
4. 检查响应状态码

**预期结果**:
- 响应状态码: 200
- 返回数据: "停用成功"

### 测试用例2: 停用不存在的用户
**测试步骤**:
1. 使用不存在的personId
2. 设置X-User-Person-Id请求头
3. 调用PUT `/api/v1/users/{personId}/deactivate` 接口
4. 检查响应状态码和错误信息

**预期结果**:
- 响应状态码: 200
- 返回数据: 错误信息，用户不存在

## 11. 分页查询用户列表接口测试

### 测试用例1: 正常分页查询用户列表
**测试步骤**:
1. 准备有效的UserQueryDTO数据
2. 设置X-Tenant-Id请求头
3. 调用POST `/api/v1/users/search` 接口
4. 检查响应状态码和返回的分页数据

**预期结果**:
- 响应状态码: 200
- 返回数据: 包含用户列表的PageResult对象

### 测试用例2: 分页查询无结果
**测试步骤**:
1. 准备查询条件无匹配的UserQueryDTO数据
2. 设置X-Tenant-Id请求头
3. 调用POST `/api/v1/users/search` 接口
4. 检查响应状态码和返回的分页数据

**预期结果**:
- 响应状态码: 200
- 返回数据: 空的用户列表，total为0