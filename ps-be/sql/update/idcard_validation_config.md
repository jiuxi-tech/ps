# ш║лф╗╜шпБхП╖цабщкМф╜НщкМшпБщЕНч╜ошп┤цШО

## щЕНч╜ощб╣

хЬи `application-base.yml` цИЦчОпхвГщЕНч╜оцЦЗф╗╢ф╕нц╖╗хКая╝Ъ

```yaml
app:
  security:
    credential:
      # ш║лф╗╜шпБхП╖цабщкМф╜НщкМшпБх╝АхЕ│
      # true: ф╕еца╝щкМшпБя╝Мх┐Ещб╗чмжхРИGB11643-1999хЫ╜хо╢цаЗхЗЖ
      # false: хо╜цЭ╛цибх╝Пя╝Мф╗ЕщкМшпБца╝х╝Пя╝МхЕБшо╕цабщкМф╜НщФЩшппя╝Ищ╗Шшодя╝Й
      idcard-checkcode-validation: false
```

## ф╕дчзНцибх╝П

### 1. ф╕еца╝цибх╝П (idcard-checkcode-validation: true)
- тЬЕ хоМхЕичмжхРИGB11643-1999хЫ╜хо╢цаЗхЗЖ
- тЬЕ х┐Ещб╗цабщкМф╜НцнгчбоцЙНшГ╜чЩ╗х╜Х
- тЪая╕П хОЖхП▓щФЩшппцХ░цНоцЧац│ХчЩ╗х╜Х
- ЁЯУЛ цОишНРчФиф║ОцЦ░ч│╗ч╗ЯцИЦцХ░цНош┤ищЗПщлШчЪДч│╗ч╗Я

### 2. хо╜цЭ╛цибх╝П (idcard-checkcode-validation: false) - щ╗Шшод
- тЬЕ ф╗ЕщкМшпБш║лф╗╜шпБхП╖ца╝х╝Пя╝И18ф╜Ня╝МцЧецЬЯхРИц│ХчнЙя╝Й
- тЪая╕П хЕБшо╕цабщкМф╜НщФЩшппчЪДш║лф╗╜шпБхП╖чЩ╗х╜Х
- ЁЯУЭ ф╝ЪхЬицЧех┐Чф╕ншо░х╜ХшнжхСКф┐бцБп
- ЁЯУЛ щАВчФиф║ОцЬЙхОЖхП▓щФЩшппцХ░цНочЪДч│╗ч╗Я

## цЧех┐Чш╛УхЗ║

### хо╜цЭ╛цибх╝ПцЧех┐Ч
```
ш║лф╗╜шпБхП╖цгАцЯе: цабщкМф╜Нф╕еца╝щкМшпБцибх╝П=false
ш║лф╗╜шпБхП╖цгАцЯе: цабщкМф╜НщкМшпБч╗УцЮЬ=false
ш║лф╗╜шпБхП╖цабщкМф╜Нф╕Нцнгчбоя╝Мф╜ЖхЕБшо╕чЩ╗х╜Х(хо╜цЭ╛цибх╝П): 441622198407136619
```

### ф╕еца╝цибх╝ПцЧех┐Ч
```
ш║лф╗╜шпБхП╖цгАцЯе: цабщкМф╜Нф╕еца╝щкМшпБцибх╝П=true
ш║лф╗╜шпБхП╖цгАцЯе: цабщкМф╜НщкМшпБч╗УцЮЬ=false
шпЖхИлчЩ╗х╜ХхЗнцНоф╕║чФицИ╖хРН: 441622198407136619
чЩ╗х╜Ххд▒ш┤ея╝Мшп╖цгАцЯечФицИ╖хРНцШпхРжцнгчбоцИЦчФицИ╖цШпхРжцЬЙцХИ
```

## цХ░цНоф┐оцнгх╗║шоо

хжВцЮЬф╜┐чФихо╜цЭ╛цибх╝Пя╝Мх╗║шооцЙзшбМцХ░цНоц╕Ец┤ЧSQLя╝Ъ

```sql
-- цЯешпвцЙАцЬЙцабщкМф╜НщФЩшппчЪДш║лф╗╜шпБхП╖
SELECT 
    PERSON_ID,
    NAME,
    IDCARD,
    -- шобчоЧцнгчбочЪДцабщкМф╜Н
    CASE 
        WHEN LENGTH(IDCARD) = 18 THEN
            -- ш┐ЩщЗМщЬАшжБхоЮчО░цабщкМф╜НшобчоЧщА╗ш╛С
            CONCAT(SUBSTRING(IDCARD, 1, 17), 'цнгчбочЪДцабщкМф╜Н')
        ELSE IDCARD
    END AS CORRECT_IDCARD
FROM tp_person_basicinfo
WHERE LENGTH(IDCARD) = 18
  AND ACTIVED = 1;

-- хРОч╗нхПпф╗ецЙ╣щЗПцЫ┤цЦ░цИЦф║║х╖еца╕хп╣
```

## чОпхвГщЕНч╜ох╗║шоо

- **х╝АхПСчОпхвГ**: `idcard-checkcode-validation: false` (ф╛┐ф║Оц╡ЛшпХ)
- **ц╡ЛшпХчОпхвГ**: `idcard-checkcode-validation: true` (хПСчО░цХ░цНощЧощвШ)
- **чФЯф║зчОпхвГ**: ца╣цНоцХ░цНош┤ищЗПхЖ│хоЪя╝Мх╗║шоощАРцнеш┐Бчз╗хИ░ф╕еца╝цибх╝П

## чЫ╕хЕ│цЦЗф╗╢

- щЕНч╜оцЦЗф╗╢: `src/main/resources/config/application-base.yml`
- щЕНч╜оч▒╗: `com.jiuxi.shared.common.config.SecurityConfig`
- щкМшпБч▒╗: `com.jiuxi.admin.security.credential.CredentialIdentifier`
