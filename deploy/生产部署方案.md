# å…šæ ¡ä¸šåŠ¡ä¸­å° ç”Ÿäº§éƒ¨ç½²æ–‡æ¡£

> **é‡è¦æ›´æ–°**ï¼šæœ¬é¡¹ç›®å·²æä¾›æ–°çš„ç”Ÿäº§é…ç½®éƒ¨ç½²æ–¹æ¡ˆï¼ŒåŒ…å«å®Œæ•´çš„é…ç½®æ–‡ä»¶å’Œè‡ªåŠ¨åŒ–å·¥å…·ã€‚  
> **æ¨èä½¿ç”¨æ–°æ–¹æ¡ˆ**ï¼š[README-ç”Ÿäº§é…ç½®éƒ¨ç½²æŒ‡å—.md](./README-ç”Ÿäº§é…ç½®éƒ¨ç½²æŒ‡å—.md)

---

## ğŸ“š éƒ¨ç½²æ–‡æ¡£å¯¼èˆª

### æ¨èæ–¹æ¡ˆï¼ˆ2024-12-02 æ›´æ–°ï¼‰

1. **[ç”Ÿäº§é…ç½®éƒ¨ç½²æŒ‡å—](./README-ç”Ÿäº§é…ç½®éƒ¨ç½²æŒ‡å—.md)** - å®Œæ•´çš„é…ç½®éƒ¨ç½²æµç¨‹
2. **[ç”Ÿäº§é…ç½®æ£€æŸ¥æ¸…å•](./ç”Ÿäº§é…ç½®æ£€æŸ¥æ¸…å•.md)** - éƒ¨ç½²å‰æ£€æŸ¥æ¸…å•ï¼ˆå»ºè®®æ‰“å°ï¼‰
3. **é…ç½®æ–‡ä»¶**: [config/application-prod.yml](./config/application-prod.yml) - ç”Ÿäº§ç¯å¢ƒé…ç½®
4. **å·¥å…·è„šæœ¬**:
   - `generate-keys.sh` - è‡ªåŠ¨ç”Ÿæˆé…ç½®å¯†é’¥
   - `validate-config.sh` - éªŒè¯é…ç½®æ–‡ä»¶

### æ—§æ–¹æ¡ˆï¼ˆCentOS Â· IP: 192.168.0.139ï¼‰

ä»¥ä¸‹æ˜¯åŸæœ‰çš„ç®€åŒ–éƒ¨ç½²æ–¹æ¡ˆï¼Œé€‚ç”¨äºå¼€å‘/æµ‹è¯•ç¯å¢ƒã€‚  
**ç”Ÿäº§ç¯å¢ƒè¯·ä½¿ç”¨ä¸Šè¿°æ¨èæ–¹æ¡ˆã€‚**

> **é€‚ç”¨ç¯å¢ƒ**ï¼šCentOS æœåŠ¡å™¨  
> **æœåŠ¡å™¨ IP**ï¼š`192.168.0.139`  
> **éƒ¨ç½²ç›®å½•**ï¼š`/root/jiuxi/lab/ps`  
> **æ–‡ä»¶è¦æ±‚**ï¼š`ps-be.jar`ï¼ˆåç«¯ï¼‰ã€`dist.zip`ï¼ˆå‰ç«¯ï¼‰

---

## ğŸ“ ä¸€ã€æœ€ç»ˆç›®å½•ç»“æ„

```bash
/root/jiuxi/lab/ps/
â”‚
â”œâ”€â”€ ps-be.jar                 # åç«¯ç¨‹åº
â”œâ”€â”€ application.yml           # ä¸»é…ç½®ï¼ˆé€šç”¨ï¼‰
â”œâ”€â”€ application-prod.yml      # ç”Ÿäº§é…ç½®ï¼ˆè¦†ç›–ï¼‰
â”œâ”€â”€ ps.log                    # åç«¯æ—¥å¿—
â”‚
â”œâ”€â”€ dist/                     # å‰ç«¯é™æ€èµ„æºï¼ˆç”± dist.zip è§£å‹ï¼‰
â”‚   â”œâ”€â”€ index.html
â”‚   â””â”€â”€ static/
â”‚
â””â”€â”€ restart.sh                # ä¸€é”®é‡å¯è„šæœ¬
```

---

## ğŸ”§ äºŒã€éƒ¨ç½²æ­¥éª¤

### 1. ä¸Šä¼ å¹¶è§£å‹å‰ç«¯
```bash
cd /root/jiuxi/lab/ps
unzip dist.zip  # ç¡®ä¿ç”Ÿæˆ dist/ ç›®å½•
```

### 2. åˆ›å»ºé…ç½®æ–‡ä»¶

#### ä¸»é…ç½®ï¼ˆé€šç”¨ï¼‰
ç•¥

#### ç”Ÿäº§é…ç½®ï¼ˆè¯·æŒ‰å®é™…ä¿®æ”¹æ•°æ®åº“ä¿¡æ¯ï¼ï¼‰
ç•¥

> ğŸ” **è®¾ç½®æ•°æ®åº“å¯†ç ï¼ˆä¸´æ—¶ï¼‰**ï¼š
> ```bash
> export DB_PASS="ä½ çš„çœŸå®æ•°æ®åº“å¯†ç "
> ```

### 3. å¯åŠ¨åç«¯
```bash
cd /root/jiuxi/lab/ps
nohup java -jar ps-be.jar --spring.profiles.active=prod > ps.log 2>&1 &
```

---

## ğŸŒ ä¸‰ã€é…ç½® Nginx

### 1. åˆ›å»ºç«™ç‚¹é…ç½®ï¼ˆè‡ªåŠ¨é€‚é…ä½ çš„ IPï¼‰
å°† `ps.conf` æ”¾åˆ° `/etc/nginx/conf.d/` ä¸‹ã€‚

### 2. é‡è½½ Nginx
```bash
sudo nginx -t && sudo systemctl reload nginx
```
 
---

## ğŸ”„ å››ã€ä¸€é”®é‡å¯è„šæœ¬

### 1. åˆ›å»ºè„šæœ¬ï¼ˆå«ä½ çš„å¯†ç å ä½ï¼‰
```bash
cat > restart.sh <<'EOF'
#!/bin/bash
cd /root/jiuxi/lab/ps

# ğŸ” è¯·ä¿®æ”¹ä¸ºçœŸå®å¯†ç ï¼
export DB_PASS="ä½ çš„çœŸå®æ•°æ®åº“å¯†ç "

# åœæ­¢æ—§è¿›ç¨‹
pkill -f ps-be.jar 2>/dev/null
sleep 2

# å¯åŠ¨æ–°è¿›ç¨‹
nohup java -jar ps-be.jar --spring.profiles.active=prod > ps.log 2>&1 &
echo "âœ… åº”ç”¨å·²é‡å¯ï¼è®¿é—® http://192.168.0.139"
EOF
```

### 2. èµ‹äºˆæƒé™
```bash
chmod +x restart.sh
```

### 3. ä½¿ç”¨
```bash
./restart.sh  # æ›´æ–°é…ç½®æˆ– JAR åè¿è¡Œæ­¤å‘½ä»¤
```

---

## âœ… äº”ã€éªŒè¯è®¿é—®

- **å‰ç«¯é¡µé¢**ï¼šæµè§ˆå™¨æ‰“å¼€ â†’ [http://192.168.0.139](http://192.168.0.139)  
- **åç«¯æ¥å£**ï¼šæµ‹è¯•å‘½ä»¤ â†’  
  ```bash
  curl http://192.168.0.139/api/health
  ```

---

## ğŸ“ å…­ã€å¸¸ç”¨å‘½ä»¤

| æ“ä½œ | å‘½ä»¤ |
|------|------|
| æŸ¥çœ‹åç«¯æ—¥å¿— | `tail -f /root/jiuxi/lab/ps/ps.log` |
| æŸ¥çœ‹ Nginx é”™è¯¯ | `tail -f /var/log/nginx/error.log` |
| é‡è½½ Nginx | `sudo nginx -s reload` |
| æŸ¥çœ‹ Java è¿›ç¨‹ | `ps aux | grep ps-be.jar` |

---

> ğŸ’¡ **éƒ¨ç½²å®Œæˆï¼ç°åœ¨å¯é€šè¿‡ `http://192.168.0.139` è®¿é—®ä½ çš„åº”ç”¨ã€‚**  
> åç»­æ›´æ–°ï¼šæ”¹é…ç½® â†’ `./restart.sh`ï¼Œæ¢å‰ç«¯ â†’ é‡æ–°è§£å‹ `dist.zip`ã€‚